
var  cenarioFalas = {
    "cenario": [
    {
        "comentario": "Primeiro cenario",
        "falas": [
            {
                "autor": "Khalisto",
                "frase": "Eu estou cansada daquela casa, meus pais não são ruins, mas as constantes brigas não me deixam mais ter uma boa noite de sono.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Minha mãe não aceita que eu não acredite no deus dela, não suporta que eu diga que não me sinto bem indo a igreja com ela, não gosta que eu me negue a rezar.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Ela me aceita enquanto pessoa trans, mas não aceita que eu não vá a igreja dela por não me sentir aceita lá.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Eu não aguento mais todo dia ter uma intriga diferente, preciso sair de casa, eu tenho como alugar uma casa só minha, vou fazer isso.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Preciso apenas ficar hoje fora de casa e depois planejar isso melhor",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Preciso apenas ficar hoje fora de casa e depois planejar isso melhor",
                "posicao-balao": [0, 0]
            }
        ],
        "opcoes": [
            "Posso ir visitar minha amiga Amanda, ela é minha melhor amiga e acabou de se mudar",
            "Posso ir visitar minha Avó Ingrid, ela tem o melhor bolo de cenoura do mundo"
        ],
        "numeroDialogos": 4,
        "estados": [1,2],
        "imagem": "img/rua.jpg",
        "personagem": ["img/khalisto.png", " "]
        
    },{
        "comentario": "cenario 1",
        "falas": [
            {
                "autor": "Amanda",
                "frase": "O que ela te fez desta vez?",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Apenas brigamos porque eu não quis rezar com ela, não foi feio, mas não aguento mais brigas todos os dias",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Amanda",
                "frase": "Eu não sei como você aguenta isso há tanto tempo.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Ela me aceitou quando me assumi, sempre achei que era obrigação minha aceitar as loucuras dela.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Amanda",
                "frase": "Não funciona assim, é obrigação dela te aceitar porque você é filha dela.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Eu sei, lá no fundo eu sei.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Amanda",
                "frase": "Você não pode mais aceitar isso, só vai piorar se você não fizer nada.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Hoje eu decidi sair de casa.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Amanda",
                "frase": "Você pode ficar aqui comigo.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Não, eu vou para casa e vou me planejar bem, eu tenho condições de morar sozinha, só preciso de um tempo para planejar tudo.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Amanda",
                "frase": "Vem passar uns dias comigo e se planeja aqui, você ta mal com essas brigas, não quero que piore.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "eu não quero te dar trabalho.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Amanda",
                "frase": "Não é trabalho, ou você vem morar comigo logo ou passar uns dias só até se mudar",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Eu realmente gosto das duas opções.",
                "posicao-balao": [0, 0]
            }
        ],
        "opcoes": [
            "Posso vir morar com Amanda.",
            "Posso passar alguns dias aqui, até me mudar para uma casa só minha."
        ],
        "numeroDialogos": 13,
        "estados": [3,4],
        "imagem": " ",
        "personagem": ""
    },{
        "comentario": "cenario 2",
        "falas": [
            {
                "autor": "Khalisto",
                "frase": "Oi vó",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Ingrid",
                "frase": "Olá Ká, por que tá com essa carinha?",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Eu e a minha mãe brigamos de novo.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Ingrid",
                "frase": "Brigaram por quê?",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Os mesmo motivos bobos de sempre, vim aqui dar um tempo da gritaria lá de casa.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Ingrid",
                "frase": "Você devia sair daquela casa, você já tem como se manter.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Na verdade eu estava pensando nisso, vou sair de casa, só preciso saber para onde ainda.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Ingrid",
                "frase": "Vem morar comigo.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Não acho que seja uma boa ideia vó",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Ingrid",
                "frase": "Eu acho, preciso de alguém para lavar a louça enquanto vejo minha novela.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Até que seria bom, mas não quero dar trabalho.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Ingrid",
                "frase": "Você não dá trabalho fica aqui comigo, nem que seja por alguns dias até achar outro lugar.",
                "posicao-balao": [0, 0]
            }
        ],
        "opcoes": [
            "Posso vir morar com minha Avó.",
            "posso passar alguns dias com ela."
        ],
        "numeroDialogos": 11,
        "estados": [5,6],
        "imagem": "img/casaAvo.png",
        "personagem": ""
    },{
        "comentario": "cenario 3",
        "falas": [
            {
                "autor": "Khalisto",
                "frase": "Estou morando com Amanda a algumas semanas, nossa convivência é na maior parte do tempo divertida e pacífica",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "mas existem momentos, momentos em que ela deixa as roupas jogadas pela sala",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "em que ela reclama porque deixo os copos sujos na pia.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Nós brigamos, apenas por coisas bobas mas brigamos.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Comecei a duvidar alguns dias atrás se deveria mesmo continuar aqui, achei um lugar para ficar e chamar de meu.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Por um lado acho que não sai de um lugar pelas brigas, para vir a outro lugar onde também tem briga todo dia.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Por outro lado, nós duas estamos agindo feito crianças e eu deveria conversar e resolver.",
                "posicao-balao": [0, 0]
            }
        ],
        "opcoes": [
            "Posso ir morar sozinha e deixar a Amanda.",
            "Posso esperar ela voltar e conversar sobre para nos resolvermos."
        ],
        "numeroDialogos": 6,
        "estados": [7,8],
        "imagem": "img/casaAmanda.png",
        "personagem": ""
    },{
        "comentario": "cenario 4",
        "falas": [
            {
                "autor": "Khalisto",
                "frase": "Passei alguns dias com Amanda, me organizei e hoje estou indo para minha própria casa, acabei de me despedir de Amanda.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Mas estou com saudades de alguns membros da minha família.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Quero ir visitar minha avó ou minha irmãzinha antes de me mudar.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Não posso fazer os dois hoje e amanha vou estar na minha casa.",
                "posicao-balao": [0, 0]
            }
        ],
        "opcoes": [
            "Posso ir ver minha avó  ingrid.",
            "Posso ir ver minha irmã Maria."
        ],
        "numeroDialogos": 3,
        "estados": [9,10],
        "imagem": "img/casaAmanda.png",
        "personagem": ""
    },{
        "comentario": "cenario 5",
        "falas": [
            {
                "autor": "Ingrid",
                "frase": "Está sendo muito bom ter você aqui essas semanas ká.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Está sendo bom para mim também vó, ta se arrumando para sair?",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Ingrid",
                "frase": "Sim vou ver seus pais, quer vir comigo?",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Não acho uma boa ideia vó.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Ingird",
                "frase": "Você vai poder ver a Maria, ela não para de perguntar de você por mensagem.",
                "posicao-balao": [0, 0]
            }
        ],
        "opcoes": [
            "Posso ir a casa dos meus pais ver minha irmã.",
            "Posso ficar aqui em casa."
        ],
        "numeroDialogos": 4,
        "estados": [11,12],
        "imagem": "img/casaAvo.png",
        "personagem": ""
    },{
        "comentario": "cenario 6",
        "falas": [
            {
                "autor": "Khalisto",
                "frase": "Passei alguns dias com minha avó e agora estou arrumando minhas coisas para minha própria casa.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Ela está neste momento com meus pais e minha irmã.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Esses dias com ela foram muito bons, amo minha vó.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Foi um descanso necessário de toda a gritaria que eu tinha com minha mãe.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Agora estou organizando minhas coisas para finalmente ter minha própria casa.",
                "posicao-balao": [0, 0]
            },
            {
                "autor": "Khalisto",
                "frase": "Enquanto me organizo para me mudar recebo uma ligação da minha mãe.",
                "posicao-balao": [0, 0]
            }
        ],
        "opcoes": [
            "Posso atender.",
            "Posso ignorar."
        ],
        "numeroDialogos": 4,
        "estados": [13,14],
        "imagem": "img/casaAvo.png",
        "personagem": ""
    }
    
]
}
var i = 0
var estadoAtual = 0

const container = document.querySelector("#container")
const fundo = document.querySelector("#fundo")
container.appendChild(fundo)
const imagemFundo = document.querySelector("#imagemFundo")
imagemFundo.src = "img/rua.jpg"
fundo.style.backgroundImage = (imagemFundo)
const personagens = document.querySelector("#personagens")
fundo.appendChild(personagens)
const personagemEsquerda = document.querySelector("#personagemEsquerda")
personagemEsquerda.src = "img/khalisto.png"
personagens.appendChild(personagemEsquerda)
/*const personagemDireita = document.querySelector("#personagemDireita")
personagemDireita.src = "img/personagemVazio.png"
personagens.appendChild(personagemDireita)*/
const lista = document.querySelector("#opcoes")
fundo.appendChild(lista)

const botaoOpcao1 = document.createElement("button")
botaoOpcao1.setAttribute("id", "opcao1")
lista.appendChild(botaoOpcao1)
const botaoOpcao2 = document.createElement("button")
botaoOpcao2.setAttribute("id", "opcao2")
lista.appendChild(botaoOpcao2)

console.log("CONSTRUIDO O FUNDO")

const caixaDeDialogo = document.querySelector("#caixaDeDialogo")
fundo.appendChild(caixaDeDialogo)
caixaDeDialogo.style.top = cenarioFalas['cenario'][0]['falas'][0]['posicao-balao'][0]
caixaDeDialogo.style.top = cenarioFalas['cenario'][0]['falas'][0]['posicao-balao'][1]
const dialogo = document.querySelector("#dialogo")
caixaDeDialogo.appendChild(dialogo)
const texto = document.querySelector("#texto")
dialogo.appendChild(texto)

const botaoNext = document.createElement("button")
botaoNext.setAttribute("id", "botaoNext")
botaoNext.innerHTML = "NEXT"
caixaDeDialogo.appendChild(botaoNext)

console.log("CONSTRUIDO DIALOGO")

mudaFundo(cenarioFalas, estadoAtual, i)
atualizaTexto(cenarioFalas, i)
desaparece(cenarioFalas, i)

function mudaFundo(cenarioFalas, estadoAtual){
    imagemFundo.src = cenarioFalas["cenario"][estadoAtual]["imagem"]
    fundo.style.backgroundImage = imagemFundo
    botaoOpcao1.innerHTML = cenarioFalas["cenario"][estadoAtual]["opcoes"][0]
    botaoOpcao2.innerHTML = cenarioFalas["cenario"][estadoAtual]["opcoes"][1]
    i=0
    atualizaTexto(cenarioFalas, i)
    desaparece(cenarioFalas, i)
    console.log("MUDA FUNDO FUNCIONA")
}
function atualizaTexto(cenarioFalas, i){
    texto.innerHTML = `<b><i>${cenarioFalas['cenario'][estadoAtual]['falas'][i]['autor']} - </i></b>${cenarioFalas['cenario'][estadoAtual]['falas'][i]['frase']}`
    console.log("ATUALIZA TEXTO FUNCIONA")
}
function desaparece(cenarioFalas, i){
    if(cenarioFalas['cenario'][0]['numeroDialogos'] >= i){
        caixaDeDialogo.style.opacity = 1
        botaoNext.style.opacity = 1
        botaoOpcao1.style.opacity = 0
        botaoOpcao2.style.opacity = 0
    }
    if(cenarioFalas['cenario'][0]['numeroDialogos'] < i){
        caixaDeDialogo.style.opacity = 0
        botaoNext.style.opacity = 0
        botaoOpcao1.style.opacity = 1
        botaoOpcao2.style.opacity = 1
    }
console.log("DESAPARECE FUNCIONA")
}
botaoNext.addEventListener("click", function(){
    i++
    atualizaTexto(cenarioFalas, i)
    desaparece(cenarioFalas, i)
    console.log("BOTAO NEXT FUNCIONA")
})
botaoOpcao1.addEventListener("click", function(){
    estadoAtual = cenarioFalas['cenario'][estadoAtual]['estados'][0]
    mudaFundo(cenarioFalas, estadoAtual)
    console.log("OPÇAO 1 FUNCIONA")
})
botaoOpcao2.addEventListener("click", function(){
    estadoAtual = cenarioFalas['cenario'][estadoAtual]['estados'][1]
    mudaFundo(cenarioFalas, estadoAtual)
    console.log("OPÇAO 2 FUNCIONA")
})